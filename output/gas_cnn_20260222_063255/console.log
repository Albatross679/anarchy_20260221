============================================================
CNN Gas Consumption Prediction — gas_cnn
Output: output/gas_cnn_20260222_063255
Utility: GAS
Seq length: 48 (12.0h)
Stride: 4
Conv channels: [64, 128, 256]
Kernel sizes: [7, 5, 3]
LR: 0.0003, weight_decay=0.0001
Batch size: 1024
Patience: 15
Seed: 42
============================================================

--- Loading Data ---
  Loaded: 751,048 rows, 48 cols, 146 buildings
  Dropping 12 sparse cross-utility columns
  Active: 115 buildings (590,968 rows)
  Always-off: 31 buildings (160,080 rows)
  Train: 250,940 | Test: 340,028
  Features (30): ['temperature_2m', 'relative_humidity_2m', 'dew_point_2m', 'direct_radiation', 'wind_speed_10m', 'cloud_cover', 'apparent_temperature', 'precipitation']...

--- Creating Sequence Datasets ---
  Train windows: 61,470
  Test windows:  83,742

--- Model ---
  Parameters: 195,265
  Device: cuda
EnergyCNN(
  (conv): Sequential(
    (0): Conv1d(30, 64, kernel_size=(7,), stride=(1,), padding=(3,))
    (1): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): GELU(approximate='none')
    (3): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Dropout(p=0.15, inplace=False)
    (5): Conv1d(64, 128, kernel_size=(5,), stride=(1,), padding=(2,))
    (6): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): GELU(approximate='none')
    (8): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (9): Dropout(p=0.15, inplace=False)
    (10): Conv1d(128, 256, kernel_size=(3,), stride=(1,), padding=(1,))
    (11): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): GELU(approximate='none')
    (13): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Dropout(p=0.15, inplace=False)
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (fc): Sequential(
    (0): Linear(in_features=256, out_features=128, bias=True)
    (1): GELU(approximate='none')
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=128, out_features=64, bias=True)
    (4): GELU(approximate='none')
    (5): Dropout(p=0.3, inplace=False)
    (6): Linear(in_features=64, out_features=1, bias=True)
  )
)

--- Training ---
  Epoch   1/80  train_loss=0.374197  val_loss=0.593968  R²=0.5870  lr=3.00e-04  patience=0/15
  Epoch   5/80  train_loss=0.286401  val_loss=0.675859  R²=0.5305  lr=2.98e-04  patience=3/15
  Epoch  10/80  train_loss=0.275024  val_loss=0.551894  R²=0.6162  lr=2.91e-04  patience=0/15
  Epoch  15/80  train_loss=0.261944  val_loss=0.586104  R²=0.5925  lr=2.78e-04  patience=1/15
  Epoch  20/80  train_loss=0.270437  val_loss=0.548739  R²=0.6184  lr=2.60e-04  patience=6/15
  Epoch  25/80  train_loss=0.251892  val_loss=0.566431  R²=0.6060  lr=2.38e-04  patience=11/15
  Early stopping at epoch 29

--- Evaluation ---
  RMSE:  0.000109
  MAE:   0.000055
  R²:    0.6237
  MAPE:  8311.12%

--- Generating Predictions ---
  Predictions saved: output/gas_cnn_20260222_063255/predictions.parquet

============================================================
Done in 525.1s
Output directory: output/gas_cnn_20260222_063255
TensorBoard:  tensorboard --logdir output/gas_cnn_20260222_063255/tensorboard
============================================================
