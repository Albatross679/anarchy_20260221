============================================================
LightGBM Energy Prediction — energy_lightgbm
Output: output/energy_lightgbm_20260222_001846
Utility: ELECTRICITY
Seed: 42
============================================================

--- Data Pipeline ---
Loading building metadata...
  Buildings with valid area: 1,178
Loading meter data...
  Raw meter readings: 692,661
  After aggregation: 391,801
  After 15-min resample: 1,567,204
  After building join: 1,549,636
  Unique buildings: 265
Loading weather data...
  After weather join: 1,544,336
  Outlier removal: 15,444 rows removed (1st-99th percentile)
  Final dataset: 1,528,892 rows, 263 buildings

--- Feature Engineering ---
  Features (25): ['temperature_2m', 'relative_humidity_2m', 'dew_point_2m', 'direct_radiation', 'wind_speed_10m', 'cloud_cover', 'apparent_temperature', 'precipitation', 'grossarea', 'floorsaboveground', 'building_age', 'hour_of_day', 'minute_of_hour', 'day_of_week', 'is_weekend', 'energy_lag_4', 'energy_lag_24', 'energy_lag_96', 'energy_lag_672', 'rolling_mean_96', 'rolling_std_96', 'rolling_mean_672', 'rolling_std_672', 'temp_x_area', 'humidity_x_area']
  Dataset after engineering: 1,352,156 rows

--- Train/Test Split ---
  Train: 570,512 rows | Test: 781,644 rows
  Features (25): ['temperature_2m', 'relative_humidity_2m', 'dew_point_2m', 'direct_radiation', 'wind_speed_10m', 'cloud_cover', 'apparent_temperature', 'precipitation', 'grossarea', 'floorsaboveground', 'building_age', 'hour_of_day', 'minute_of_hour', 'day_of_week', 'is_weekend', 'energy_lag_4', 'energy_lag_24', 'energy_lag_96', 'energy_lag_672', 'rolling_mean_96', 'rolling_std_96', 'rolling_mean_672', 'rolling_std_672', 'temp_x_area', 'humidity_x_area']

--- Training ---
Training until validation scores don't improve for 50 rounds
[50]	train's rmse: 5.39868e-05	validation's rmse: 5.93396e-05
[100]	train's rmse: 4.22073e-05	validation's rmse: 5.29458e-05
[150]	train's rmse: 4.07415e-05	validation's rmse: 5.22661e-05
[200]	train's rmse: 3.99902e-05	validation's rmse: 5.2121e-05
[250]	train's rmse: 3.9822e-05	validation's rmse: 5.20535e-05
Early stopping, best iteration is:
[246]	train's rmse: 3.98221e-05	validation's rmse: 5.20531e-05
  TensorBoard logs: output/energy_lightgbm_20260222_001846/tensorboard

--- Evaluation ---
  SHAP plots saved.
  RMSE:  0.000052
  MAE:   0.000013
  R²:    0.9601
  MAPE:  436.86%
  Trees: 246

--- Saving ---
  Model saved: output/energy_lightgbm_20260222_001846/checkpoints/model_best.txt
  Predictions saved: output/energy_lightgbm_20260222_001846/predictions.parquet

============================================================
Done in 250.8s
Output directory: output/energy_lightgbm_20260222_001846
============================================================
