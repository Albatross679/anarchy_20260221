============================================================
CNN Energy Prediction — energy_cnn
Output: output/energy_cnn_20260221_204822
Utility: ELECTRICITY
Seq length: 24
Seed: 42
============================================================

--- Data Pipeline ---
Loading building metadata...
  Buildings with valid area: 1,178
Loading meter data...
  Raw meter readings: 692,661
  After aggregation: 391,801
  After building join: 387,409
  Unique buildings: 265
Loading weather data...
  After weather join: 386,084
  Outlier removal: 3,861 rows removed (1st-99th percentile)
  Final dataset: 382,223 rows, 263 buildings

--- Train/Test Split ---
Train: 186,812 rows | Test: 195,411 rows

--- Creating Sequence Datasets ---
  Train windows: 180,763
  Test windows:  189,362

--- Model ---
  Parameters: 41,057
  Device: cuda
EnergyCNN(
  (conv): Sequential(
    (0): Conv1d(14, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Dropout(p=0.2, inplace=False)
    (5): Conv1d(32, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    (6): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU()
    (8): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (9): Dropout(p=0.2, inplace=False)
    (10): Conv1d(64, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (11): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU()
    (13): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Dropout(p=0.2, inplace=False)
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)

--- Training ---
  Epoch   1/100  train_loss=0.748396  val_loss=0.773831  R²=-0.0775  lr=1.00e-03  patience=0/999
  Epoch   5/100  train_loss=0.607869  val_loss=0.562531  R²=0.2167  lr=9.96e-04  patience=0/999
  Epoch  10/100  train_loss=0.485460  val_loss=0.376117  R²=0.4763  lr=9.80e-04  patience=1/999
  Epoch  15/100  train_loss=0.432218  val_loss=0.289781  R²=0.5965  lr=9.52e-04  patience=0/999
  Epoch  20/100  train_loss=0.401352  val_loss=0.265567  R²=0.6302  lr=9.14e-04  patience=2/999
  Epoch  25/100  train_loss=0.379572  val_loss=0.316547  R²=0.5592  lr=8.64e-04  patience=3/999
  Epoch  30/100  train_loss=0.355822  val_loss=0.247571  R²=0.6553  lr=8.06e-04  patience=2/999
  Epoch  35/100  train_loss=0.353606  val_loss=0.222032  R²=0.6908  lr=7.41e-04  patience=1/999
  Epoch  40/100  train_loss=0.356337  val_loss=0.211303  R²=0.7058  lr=6.69e-04  patience=3/999
  Epoch  45/100  train_loss=0.347320  val_loss=0.210240  R²=0.7072  lr=5.94e-04  patience=8/999
  Epoch  50/100  train_loss=0.335632  val_loss=0.201223  R²=0.7198  lr=5.16e-04  patience=13/999
  Epoch  55/100  train_loss=0.326526  val_loss=0.202101  R²=0.7186  lr=4.37e-04  patience=1/999
  Epoch  60/100  train_loss=0.325699  val_loss=0.191889  R²=0.7328  lr=3.61e-04  patience=1/999
  Epoch  65/100  train_loss=0.319406  val_loss=0.192141  R²=0.7324  lr=2.87e-04  patience=6/999
  Epoch  70/100  train_loss=0.321950  val_loss=0.176748  R²=0.7539  lr=2.19e-04  patience=0/999
  Epoch  75/100  train_loss=0.313268  val_loss=0.184126  R²=0.7436  lr=1.58e-04  patience=5/999
  Epoch  80/100  train_loss=0.305066  val_loss=0.176731  R²=0.7539  lr=1.05e-04  patience=0/999
  Epoch  85/100  train_loss=0.305483  val_loss=0.177892  R²=0.7523  lr=6.18e-05  patience=1/999
  Epoch  90/100  train_loss=0.310129  val_loss=0.176069  R²=0.7548  lr=2.96e-05  patience=0/999
  Epoch  95/100  train_loss=0.313892  val_loss=0.178357  R²=0.7516  lr=8.86e-06  patience=1/999
  Epoch 100/100  train_loss=0.312421  val_loss=0.182527  R²=0.7458  lr=2.47e-07  patience=2/999

--- Evaluation ---
  RMSE:  0.000501
  MAE:   0.000246
  R²:    0.7620
  MAPE:  8252.33%

--- Generating Predictions ---
  Predictions saved: output/energy_cnn_20260221_204822/predictions.parquet

============================================================
Done in 901.5s
Output directory: output/energy_cnn_20260221_204822
TensorBoard:  tensorboard --logdir output/energy_cnn_20260221_204822/tensorboard
============================================================
