============================================================
Quantile Regression Forest Energy Prediction -- energy_qrf
Output: output/energy_qrf_20260222_005552
Utility: ELECTRICITY
Seed: 42
============================================================

--- Data Pipeline ---
Loading building metadata...
  Buildings with valid area: 1,178
Loading meter data...
  Raw meter readings: 692,661
  After aggregation: 391,801
  After 15-min resample: 1,567,204
  After building join: 1,549,636
  Unique buildings: 265
Loading weather data...
  After weather join: 1,544,336
  Outlier removal: 15,444 rows removed (1st-99th percentile)
  Final dataset: 1,528,892 rows, 263 buildings

--- Feature Engineering ---
  Features (25): ['temperature_2m', 'relative_humidity_2m', 'dew_point_2m', 'direct_radiation', 'wind_speed_10m', 'cloud_cover', 'apparent_temperature', 'precipitation', 'grossarea', 'floorsaboveground', 'building_age', 'hour_of_day', 'minute_of_hour', 'day_of_week', 'is_weekend', 'energy_lag_4', 'energy_lag_24', 'energy_lag_96', 'energy_lag_672', 'rolling_mean_96', 'rolling_std_96', 'rolling_mean_672', 'rolling_std_672', 'temp_x_area', 'humidity_x_area']
  Dataset after engineering: 1,352,156 rows

--- Train/Test Split ---
  Train: 570,512 rows | Test: 781,644 rows
  Features (25): ['temperature_2m', 'relative_humidity_2m', 'dew_point_2m', 'direct_radiation', 'wind_speed_10m', 'cloud_cover', 'apparent_temperature', 'precipitation', 'grossarea', 'floorsaboveground', 'building_age', 'hour_of_day', 'minute_of_hour', 'day_of_week', 'is_weekend', 'energy_lag_4', 'energy_lag_24', 'energy_lag_96', 'energy_lag_672', 'rolling_mean_96', 'rolling_std_96', 'rolling_mean_672', 'rolling_std_672', 'temp_x_area', 'humidity_x_area']

--- Training ---
  TensorBoard logs: output/energy_qrf_20260222_005552/tensorboard

--- Evaluation ---
PermutationExplainer explainer:   1%|1         | 1/100 [00:00<?, ?it/s]PermutationExplainer explainer:   3%|3         | 3/100 [00:24<01:23,  1.16it/s]PermutationExplainer explainer:   4%|4         | 4/100 [00:26<02:16,  1.42s/it]PermutationExplainer explainer:   5%|5         | 5/100 [00:28<02:24,  1.52s/it]PermutationExplainer explainer:   6%|6         | 6/100 [00:29<02:24,  1.54s/it]PermutationExplainer explainer:   7%|7         | 7/100 [00:31<02:23,  1.55s/it]PermutationExplainer explainer:   8%|8         | 8/100 [00:32<02:12,  1.44s/it]PermutationExplainer explainer:   9%|9         | 9/100 [00:33<02:05,  1.37s/it]PermutationExplainer explainer:  10%|#         | 10/100 [00:35<02:00,  1.34s/it]PermutationExplainer explainer:  11%|#1        | 11/100 [00:36<01:58,  1.33s/it]PermutationExplainer explainer:  12%|#2        | 12/100 [00:37<01:58,  1.35s/it]PermutationExplainer explainer:  13%|#3        | 13/100 [00:39<01:57,  1.36s/it]PermutationExplainer explainer:  14%|#4        | 14/100 [00:40<01:54,  1.33s/it]PermutationExplainer explainer:  15%|#5        | 15/100 [00:42<02:00,  1.42s/it]PermutationExplainer explainer:  16%|#6        | 16/100 [00:44<02:10,  1.55s/it]PermutationExplainer explainer:  17%|#7        | 17/100 [00:45<02:16,  1.64s/it]PermutationExplainer explainer:  18%|#8        | 18/100 [00:47<02:24,  1.76s/it]PermutationExplainer explainer:  19%|#9        | 19/100 [00:49<02:13,  1.65s/it]PermutationExplainer explainer:  20%|##        | 20/100 [00:50<02:11,  1.65s/it]PermutationExplainer explainer:  21%|##1       | 21/100 [00:52<02:10,  1.65s/it]PermutationExplainer explainer:  22%|##2       | 22/100 [00:54<02:09,  1.67s/it]PermutationExplainer explainer:  23%|##3       | 23/100 [00:55<02:03,  1.60s/it]PermutationExplainer explainer:  24%|##4       | 24/100 [00:57<01:59,  1.57s/it]PermutationExplainer explainer:  25%|##5       | 25/100 [00:58<01:50,  1.48s/it]PermutationExplainer explainer:  26%|##6       | 26/100 [00:59<01:47,  1.45s/it]PermutationExplainer explainer:  27%|##7       | 27/100 [01:01<01:42,  1.41s/it]PermutationExplainer explainer:  28%|##8       | 28/100 [01:02<01:43,  1.44s/it]PermutationExplainer explainer:  29%|##9       | 29/100 [01:04<01:41,  1.43s/it]PermutationExplainer explainer:  30%|###       | 30/100 [01:05<01:37,  1.39s/it]PermutationExplainer explainer:  31%|###1      | 31/100 [01:06<01:31,  1.33s/it]PermutationExplainer explainer:  32%|###2      | 32/100 [01:07<01:31,  1.34s/it]PermutationExplainer explainer:  33%|###3      | 33/100 [01:09<01:25,  1.28s/it]PermutationExplainer explainer:  34%|###4      | 34/100 [01:10<01:25,  1.29s/it]PermutationExplainer explainer:  35%|###5      | 35/100 [01:11<01:27,  1.35s/it]PermutationExplainer explainer:  36%|###6      | 36/100 [01:13<01:23,  1.31s/it]PermutationExplainer explainer:  37%|###7      | 37/100 [01:14<01:20,  1.28s/it]PermutationExplainer explainer:  38%|###8      | 38/100 [01:16<01:28,  1.42s/it]PermutationExplainer explainer:  39%|###9      | 39/100 [01:17<01:26,  1.42s/it]PermutationExplainer explainer:  40%|####      | 40/100 [01:18<01:24,  1.41s/it]PermutationExplainer explainer:  41%|####1     | 41/100 [01:20<01:19,  1.34s/it]PermutationExplainer explainer:  42%|####2     | 42/100 [01:21<01:15,  1.30s/it]PermutationExplainer explainer:  43%|####3     | 43/100 [01:22<01:14,  1.31s/it]PermutationExplainer explainer:  44%|####4     | 44/100 [01:24<01:19,  1.41s/it]PermutationExplainer explainer:  45%|####5     | 45/100 [01:25<01:22,  1.50s/it]PermutationExplainer explainer:  46%|####6     | 46/100 [01:27<01:23,  1.55s/it]PermutationExplainer explainer:  47%|####6     | 47/100 [01:28<01:16,  1.45s/it]PermutationExplainer explainer:  48%|####8     | 48/100 [01:30<01:13,  1.42s/it]PermutationExplainer explainer:  49%|####9     | 49/100 [01:31<01:14,  1.46s/it]PermutationExplainer explainer:  50%|#####     | 50/100 [01:32<01:09,  1.39s/it]PermutationExplainer explainer:  51%|#####1    | 51/100 [01:34<01:09,  1.41s/it]PermutationExplainer explainer:  52%|#####2    | 52/100 [01:35<01:09,  1.45s/it]PermutationExplainer explainer:  53%|#####3    | 53/100 [01:37<01:03,  1.35s/it]PermutationExplainer explainer:  54%|#####4    | 54/100 [01:38<01:01,  1.34s/it]PermutationExplainer explainer:  55%|#####5    | 55/100 [01:39<01:01,  1.36s/it]PermutationExplainer explainer:  56%|#####6    | 56/100 [01:41<01:00,  1.37s/it]PermutationExplainer explainer:  57%|#####6    | 57/100 [01:42<01:00,  1.40s/it]PermutationExplainer explainer:  58%|#####8    | 58/100 [01:43<00:55,  1.33s/it]PermutationExplainer explainer:  59%|#####8    | 59/100 [01:45<01:00,  1.49s/it]PermutationExplainer explainer:  60%|######    | 60/100 [01:47<01:00,  1.52s/it]PermutationExplainer explainer:  61%|######1   | 61/100 [01:48<00:59,  1.53s/it]PermutationExplainer explainer:  62%|######2   | 62/100 [01:50<01:03,  1.67s/it]PermutationExplainer explainer:  63%|######3   | 63/100 [01:52<01:04,  1.73s/it]PermutationExplainer explainer:  64%|######4   | 64/100 [01:54<01:00,  1.69s/it]PermutationExplainer explainer:  65%|######5   | 65/100 [01:56<01:05,  1.88s/it]PermutationExplainer explainer:  66%|######6   | 66/100 [01:58<01:02,  1.83s/it]PermutationExplainer explainer:  67%|######7   | 67/100 [02:00<01:00,  1.84s/it]PermutationExplainer explainer:  68%|######8   | 68/100 [02:02<00:59,  1.87s/it]PermutationExplainer explainer:  69%|######9   | 69/100 [02:03<00:56,  1.81s/it]PermutationExplainer explainer:  70%|#######   | 70/100 [02:05<00:53,  1.79s/it]PermutationExplainer explainer:  71%|#######1  | 71/100 [02:07<00:53,  1.83s/it]PermutationExplainer explainer:  72%|#######2  | 72/100 [02:09<00:51,  1.83s/it]PermutationExplainer explainer:  73%|#######3  | 73/100 [02:10<00:47,  1.78s/it]PermutationExplainer explainer:  74%|#######4  | 74/100 [02:12<00:47,  1.82s/it]PermutationExplainer explainer:  75%|#######5  | 75/100 [02:14<00:46,  1.86s/it]PermutationExplainer explainer:  76%|#######6  | 76/100 [02:16<00:44,  1.86s/it]PermutationExplainer explainer:  77%|#######7  | 77/100 [02:18<00:43,  1.90s/it]PermutationExplainer explainer:  78%|#######8  | 78/100 [02:20<00:41,  1.89s/it]PermutationExplainer explainer:  79%|#######9  | 79/100 [02:22<00:41,  1.98s/it]PermutationExplainer explainer:  80%|########  | 80/100 [02:24<00:39,  1.99s/it]PermutationExplainer explainer:  81%|########1 | 81/100 [02:26<00:38,  2.04s/it]PermutationExplainer explainer:  82%|########2 | 82/100 [02:28<00:36,  2.02s/it]PermutationExplainer explainer:  83%|########2 | 83/100 [02:30<00:34,  2.00s/it]PermutationExplainer explainer:  84%|########4 | 84/100 [02:33<00:33,  2.08s/it]PermutationExplainer explainer:  85%|########5 | 85/100 [02:35<00:32,  2.15s/it]PermutationExplainer explainer:  86%|########6 | 86/100 [02:37<00:28,  2.03s/it]PermutationExplainer explainer:  87%|########7 | 87/100 [02:39<00:28,  2.16s/it]PermutationExplainer explainer:  88%|########8 | 88/100 [02:41<00:25,  2.11s/it]PermutationExplainer explainer:  89%|########9 | 89/100 [02:43<00:22,  2.05s/it]PermutationExplainer explainer:  90%|######### | 90/100 [02:45<00:19,  1.95s/it]PermutationExplainer explainer:  91%|#########1| 91/100 [02:47<00:17,  1.98s/it]PermutationExplainer explainer:  92%|#########2| 92/100 [02:49<00:15,  1.97s/it]PermutationExplainer explainer:  93%|#########3| 93/100 [02:50<00:13,  1.88s/it]PermutationExplainer explainer:  94%|#########3| 94/100 [02:52<00:10,  1.76s/it]PermutationExplainer explainer:  95%|#########5| 95/100 [02:53<00:08,  1.64s/it]PermutationExplainer explainer:  96%|#########6| 96/100 [02:55<00:07,  1.80s/it]PermutationExplainer explainer:  97%|#########7| 97/100 [02:57<00:05,  1.87s/it]PermutationExplainer explainer:  98%|#########8| 98/100 [02:59<00:03,  1.89s/it]PermutationExplainer explainer:  99%|#########9| 99/100 [03:01<00:01,  1.81s/it]PermutationExplainer explainer: 100%|##########| 100/100 [03:03<00:00,  1.85s/it]PermutationExplainer explainer: 101it [03:05,  1.78s/it]                         PermutationExplainer explainer: 101it [03:05,  1.85s/it]
/teamspace/studios/this_studio/hackathon/qrf/model.py:294: FutureWarning: The NumPy global RNG was seeded by calling `np.random.seed`. In a future version this function will no longer use the global RNG. Pass `rng` explicitly to opt-in to the new behaviour and silence this warning.
  shap.summary_plot(shap_values, X_sample, show=False)
/teamspace/studios/this_studio/hackathon/qrf/model.py:298: FutureWarning: The NumPy global RNG was seeded by calling `np.random.seed`. In a future version this function will no longer use the global RNG. Pass `rng` explicitly to opt-in to the new behaviour and silence this warning.
  shap.summary_plot(shap_values, X_sample, plot_type="bar", show=False)
  SHAP plots saved.
  RMSE:  0.000048
  MAE:   0.000013
  R2:    0.9663
  MAPE:  34.46%
  Trees: 10

--- Saving ---
  Model saved: output/energy_qrf_20260222_005552/checkpoints/model_best.joblib
  Predictions saved: output/energy_qrf_20260222_005552/predictions.parquet

============================================================
Done in 275.8s
Output directory: output/energy_qrf_20260222_005552
============================================================
