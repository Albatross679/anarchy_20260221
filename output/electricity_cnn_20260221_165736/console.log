============================================================
CNN Energy Prediction — energy_cnn
Output: output/energy_cnn_20260221_165736
Utility: ELECTRICITY
Seq length: 24
Seed: 42
============================================================

--- Data Pipeline ---
Loading meter data...
  Raw meter readings: 692,661
  After aggregation: 391,801
Loading building metadata...
  Buildings with valid area: 1,178
  After building join: 387,409
  Unique buildings: 265
Loading weather data...
  After weather join: 386,084
  Outlier removal: 3,861 rows removed (1st-99th percentile)
  Final dataset: 382,223 rows, 263 buildings

--- Train/Test Split ---
Train: 186,812 rows | Test: 195,411 rows

--- Creating Sequence Datasets ---
  Train windows: 180,763
  Test windows:  189,362

--- Model ---
  Parameters: 41,057
  Device: cuda
EnergyCNN(
  (conv): Sequential(
    (0): Conv1d(14, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Dropout(p=0.2, inplace=False)
    (5): Conv1d(32, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    (6): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU()
    (8): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (9): Dropout(p=0.2, inplace=False)
    (10): Conv1d(64, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (11): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU()
    (13): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Dropout(p=0.2, inplace=False)
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)

--- Training ---
  Epoch   1/50  train_loss=0.732026  val_loss=0.671798  lr=1.00e-03  patience=0/10
  Epoch   5/50  train_loss=0.606760  val_loss=0.738924  lr=9.84e-04  patience=4/10
  Epoch  10/50  train_loss=0.485561  val_loss=0.371783  lr=9.22e-04  patience=0/10
  Epoch  15/50  train_loss=0.428832  val_loss=0.304939  lr=8.19e-04  patience=0/10
  Epoch  20/50  train_loss=0.401685  val_loss=0.259785  lr=6.84e-04  patience=0/10
  Epoch  25/50  train_loss=0.378018  val_loss=0.268126  lr=5.31e-04  patience=5/10
  Epoch  30/50  train_loss=0.362246  val_loss=0.237990  lr=3.76e-04  patience=0/10
  Epoch  35/50  train_loss=0.351573  val_loss=0.249639  lr=2.32e-04  patience=2/10
  Epoch  40/50  train_loss=0.340209  val_loss=0.252490  lr=1.15e-04  patience=7/10
  Early stopping at epoch 43

--- Evaluation ---
  RMSE:  0.000578
  MAE:   0.000304
  R²:    0.6825
  MAPE:  16189.85%

  Model saved: output/energy_cnn_20260221_165736/checkpoints/model_best.pt

--- Generating Predictions ---
  Predictions saved: output/energy_cnn_20260221_165736/predictions.parquet

============================================================
Done in 431.7s
Output directory: output/energy_cnn_20260221_165736
TensorBoard:  tensorboard --logdir output/energy_cnn_20260221_165736/tensorboard
============================================================
