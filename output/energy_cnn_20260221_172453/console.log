============================================================
CNN Energy Prediction — energy_cnn
Output: output/energy_cnn_20260221_172453
Utility: ELECTRICITY
Seq length: 24
Seed: 42
============================================================

--- Data Pipeline ---
Loading meter data...
  Raw meter readings: 692,661
  After aggregation: 391,801
Loading building metadata...
  Buildings with valid area: 1,178
  After building join: 387,409
  Unique buildings: 265
Loading weather data...
  After weather join: 386,084
  Outlier removal: 3,861 rows removed (1st-99th percentile)
  Final dataset: 382,223 rows, 263 buildings

--- Train/Test Split ---
Train: 186,812 rows | Test: 195,411 rows

--- Creating Sequence Datasets ---
  Train windows: 180,763
  Test windows:  189,362

--- Model ---
  Parameters: 41,057
  Device: cuda
EnergyCNN(
  (conv): Sequential(
    (0): Conv1d(14, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    (1): BatchNorm1d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU()
    (3): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Dropout(p=0.2, inplace=False)
    (5): Conv1d(32, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    (6): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (7): ReLU()
    (8): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (9): Dropout(p=0.2, inplace=False)
    (10): Conv1d(64, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    (11): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): ReLU()
    (13): MaxPool1d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (14): Dropout(p=0.2, inplace=False)
  )
  (pool): AdaptiveAvgPool1d(output_size=1)
  (fc): Sequential(
    (0): Linear(in_features=128, out_features=64, bias=True)
    (1): ReLU()
    (2): Dropout(p=0.3, inplace=False)
    (3): Linear(in_features=64, out_features=1, bias=True)
  )
)

--- Training ---
  Epoch   1/100  train_loss=0.745429  val_loss=1.006509  R²=-0.4015  lr=1.00e-03  patience=0/999
  Epoch   5/100  train_loss=0.595538  val_loss=1.025420  R²=-0.4279  lr=9.96e-04  patience=1/999
  Epoch  10/100  train_loss=0.472167  val_loss=0.377388  R²=0.4745  lr=9.80e-04  patience=0/999
  Epoch  15/100  train_loss=0.431237  val_loss=0.343498  R²=0.5217  lr=9.52e-04  patience=2/999
  Epoch  20/100  train_loss=0.395073  val_loss=0.287490  R²=0.5997  lr=9.14e-04  patience=1/999
  Epoch  25/100  train_loss=0.380031  val_loss=0.294487  R²=0.5900  lr=8.64e-04  patience=6/999
  Epoch  30/100  train_loss=0.352933  val_loss=0.241460  R²=0.6638  lr=8.06e-04  patience=0/999
  Epoch  35/100  train_loss=0.364990  val_loss=0.267286  R²=0.6279  lr=7.41e-04  patience=5/999
  Epoch  40/100  train_loss=0.344661  val_loss=0.306184  R²=0.5737  lr=6.69e-04  patience=3/999
  Epoch  45/100  train_loss=0.330240  val_loss=0.227977  R²=0.6826  lr=5.94e-04  patience=3/999
  Epoch  50/100  train_loss=0.323500  val_loss=0.236565  R²=0.6706  lr=5.16e-04  patience=8/999
  Epoch  55/100  train_loss=0.311984  val_loss=0.306015  R²=0.5739  lr=4.37e-04  patience=1/999
  Epoch  60/100  train_loss=0.312606  val_loss=0.233677  R²=0.6747  lr=3.61e-04  patience=6/999
  Epoch  65/100  train_loss=0.312918  val_loss=0.239253  R²=0.6669  lr=2.87e-04  patience=3/999
  Epoch  70/100  train_loss=0.311514  val_loss=0.226506  R²=0.6846  lr=2.19e-04  patience=8/999
  Epoch  75/100  train_loss=0.299851  val_loss=0.236276  R²=0.6710  lr=1.58e-04  patience=13/999
  Epoch  80/100  train_loss=0.300967  val_loss=0.256829  R²=0.6424  lr=1.05e-04  patience=18/999
  Epoch  85/100  train_loss=0.295882  val_loss=0.253475  R²=0.6471  lr=6.18e-05  patience=23/999
  Epoch  90/100  train_loss=0.294525  val_loss=0.223841  R²=0.6883  lr=2.96e-05  patience=28/999
  Epoch  95/100  train_loss=0.291163  val_loss=0.226785  R²=0.6842  lr=8.86e-06  patience=33/999
  Epoch 100/100  train_loss=0.292457  val_loss=0.216608  R²=0.6984  lr=2.47e-07  patience=38/999

--- Evaluation ---
  RMSE:  0.000541
  MAE:   0.000278
  R²:    0.7224
  MAPE:  13167.41%

  Model saved: output/energy_cnn_20260221_172453/checkpoints/model_best.pt

--- Generating Predictions ---
  Predictions saved: output/energy_cnn_20260221_172453/predictions.parquet

============================================================
Done in 705.1s
Output directory: output/energy_cnn_20260221_172453
TensorBoard:  tensorboard --logdir output/energy_cnn_20260221_172453/tensorboard
============================================================
